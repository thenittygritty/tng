(function(e){"use strict";var t="w00t!",n=e[t].config;n.postUrl="http://"+n.domain+"/linkpost/";var i=e[t]={version:"1.8.1",config:n,init:function(){i.appendForm();var e=document.getElementById("inputtitle");e.select()},appendForm:function(){var n,o,a,r,l,d,s,p,c,m,u,h,g=document.createTextNode("Edit Your Linkpost"),f=document.createTextNode("//"),x=document.createTextNode("Create Linkpost"),b=i.getSelectionHtml(),y=e.location;n=i.getStyledElement("div",{font:'300 14px/18px "Helvetica Neue", "Helvetica", sans-serif',"box-sizing":"boder-box",position:"fixed","background-color":"#f7f6f3",height:"662px","z-index":99999,padding:"15px","font-weight":"400",width:"100%","max-width":"500px",top:"20px",left:0,right:0,bottom:0,margin:"auto","-webkit-box-shadow":"0 1px 3px rgba(0, 0, 0, 0.5)","box-shadow":"0 1px 3px rgba(0, 0, 0, 0.5)","border-radius":"5px","float":"none"}),o=i.getStyledElement("h1",{display:"block",font:'bold 20px/24px "Helvetica Neue", "Helvetica", sans-serif',color:"#5b88bb",margin:"0 0 15px 0","text-transform":"none","float":"none",padding:0}),s=i.getStyledElement("span",{color:"#e02d0d",font:'300 20px/24px "Helvetica Neue", "Helvetica", sans-serif',"font-weight":"bold","padding-right":"10px","float":"none"}),p={font:'300 14px/18px "Helvetica Neue", "Helvetica", sans-serif',"box-sizing":"border-box",padding:"5px",display:"block",width:"500px","margin-bottom":"10px",border:"1px solid #ccc",margin:"0 0 15px 0","border-radius":"2px","float":"none"},c=i.getStyledElement("input",p),m=i.getStyledElement("input",p),u=i.getStyledElement("input",p),h=i.getStyledElement("input",p),a=i.getStyledElement("textarea",{font:'300 14px/18px "Helvetica Neue", "Helvetica", sans-serif',"box-sizing":"border-box",margin:0,display:"block",width:"100%",height:"400px",border:"1px solid #ccc","border-radius":"2px","float":"none"}),r=i.getStyledElement("form"),l=i.getStyledElement("div",{display:"block",height:"28px",position:"relative"}),d=i.getStyledElement("button",{font:'300 14px/18px "Helvetica Neue", "Helvetica", sans-serif',display:"block","margin-top":"15px","background-color":"#e02d0d",color:"white",border:"none","border-radius":"2px",padding:"5px",position:"absolute",right:"0","float":"none"}),d.addEventListener("click",i.createLinkPost),b&&(a.value="> "+b),n.id="linkpostformcontainer",r.id="linkpostform",m.name="title",m.type="text",m.value=document.title,m.placeholder="Title",m.id="inputtitle",c.value=y,c.name="link",c.type="text",c.placeholder="URL",u.name="author",u.type="text",u.value=e[t].config.author,u.placeholder="Author",h.name="credit",h.type="text",h.placeholder="Credit (optional)",a.name="text",n.appendChild(r),s.appendChild(f),o.appendChild(s),o.appendChild(g),d.appendChild(x),r.appendChild(o),r.appendChild(m),r.appendChild(c),r.appendChild(u),r.appendChild(h),r.appendChild(a),l.appendChild(d),r.appendChild(l),document.body.insertBefore(n)},getSelectionHtml:function(){var t=e.getSelection(),n=""+t;return n},getStyledElement:function(e,t){var n=document.createElement(e);if(n.style.cssText="",void 0!==t)for(var i in t)n.style.cssText+=i+":"+t[i]+" !important;";return n},createLinkPost:function(n){var i=function(){function e(){console.log("AJAXSubmit - Success!")}function t(t){var n=new XMLHttpRequest;if(n.submittedData=t,n.onload=e,0===t.technique)n.open("get",t.receiver.replace(/(?:\?.*)?$/,t.segments.length>0?"?"+t.segments.join("&"):""),!0),n.send(null);else if(n.open("post",t.receiver,!0),3===t.technique){var i="---------------------------"+Date.now().toString(16);n.setRequestHeader("Content-Type","multipart/form-data; boundary="+i),n.sendAsBinary("--"+i+"\r\n"+t.segments.join("--"+i+"\r\n")+"--"+i+"--\r\n")}else n.setRequestHeader("Content-Type",t.contentType),n.send(t.segments.join(2===t.technique?"\r\n":"&"))}function n(e){e.status>0||t(e)}function i(e){this.owner.segments[this.segmentIdx]+=e.target.result+"\r\n",this.owner.status--,n(this.owner)}function o(e){return e.replace(/[\s\=\\]/g,"\\$&")}function a(e){var t,a,r,l,d,s="post"===e.method.toLowerCase();this.contentType=s&&e.enctype?e.enctype:"application/x-www-form-urlencoded",this.technique=s?"multipart/form-data"===this.contentType?3:"text/plain"===this.contentType?2:1:0,this.receiver=e.action,this.status=0,this.segments=[];for(var p=2===this.technique?o:escape,c=0;e.elements.length>c;c++)if(r=e.elements[c],r.hasAttribute("name"))if(a="INPUT"===r.nodeName.toUpperCase()?r.getAttribute("type").toUpperCase():"TEXT","FILE"===a&&r.files.length>0)if(3===this.technique)for(t=0;r.files.length>t;t++)d=r.files[t],l=new FileReader,l.segmentIdx=this.segments.length,l.owner=this,l.onload=i,this.segments.push('Content-Disposition: form-data; name="'+r.name+'"; filename="'+d.name+'"\r\nContent-Type: '+d.type+"\r\n\r\n"),this.status++,l.readAsBinaryString(d);else for(t=0;r.files.length>t;this.segments.push(p(r.name)+"="+p(r.files[t++].name)));else("RADIO"!==a&&"CHECKBOX"!==a||r.checked)&&this.segments.push(3===this.technique?'Content-Disposition: form-data; name="'+r.name+'"\r\n\r\n'+r.value+"\r\n":p(r.name)+"="+p(r.value));n(this)}return function(e){e.action&&new a(e)}}(),o=document.getElementById("linkpostform");o.action=e[t].config.postUrl,o.method="get",o.enctype="application/x-www-form-urlencoded",i(o);var a=document.getElementById("linkpostformcontainer"),r=document.getElementById("dimmerdiv");document.body.removeChild(a),document.body.removeChild(r),n.preventDefault()}}})(window);